# ZapFS Metadata Server Configuration
# All keys use underscores for consistency with CLI flags and environment variables
# Environment variables: ZAPFS_HTTP_PORT, ZAPFS_GRPC_PORT, etc.

# Network
ip = "0.0.0.0"
http_port = 8082
grpc_port = 8083
debug_port = 8085

# TLS (optional)
cert_file = ""
key_file = ""

# Logging
log_level = "info"

# Manager connection
manager_addr = "localhost:8050"

# S3 API
s3_domains = ["localhost"]

# Regional
region_id = "us-west"

# Storage configuration (optional - defaults will be created if not specified)
pools_config = ""
profiles_config = ""
data_dir = "/tmp/zapfs/data"

# Database
# Supported drivers: vitess, mysql (postgres/cockroachdb planned)
db_driver = "vitess"
db_dsn = ""  # e.g., "zapfs:zapfs@tcp(localhost:3306)/zapfs?parseTime=true"
db_max_open_conns = 25
db_max_idle_conns = 5

# Rate Limiting
rate_limit_enabled = true
rate_limit_burst_multiplier = 2

# Redis for distributed rate limiting (optional)
# Enable this when running multiple metadata servers to coordinate rate limits
rate_limit_redis_enabled = false
rate_limit_redis_addr = "localhost:6379"
rate_limit_redis_password = ""
rate_limit_redis_db = 0
rate_limit_redis_pool_size = 10
rate_limit_redis_fail_open = true

# Access Logging (Enterprise: FeatureAuditLog)
# Requires ClickHouse for time-series storage
access_logs_enabled = false
clickhouse_dsn = ""
access_log_batch_size = 10000
access_log_flush_interval = "5s"
access_log_export_interval = "1h"

# Lifecycle Scanner (Community Feature)
# Scans buckets for lifecycle rules and executes expiration/abort actions
# Storage transitions require Enterprise edition
lifecycle_scanner_enabled = false
lifecycle_scan_interval = "1h"        # How often to scan buckets
lifecycle_scan_concurrency = 5        # Parallel bucket processing
lifecycle_scan_batch_size = 1000      # Objects per batch when listing
lifecycle_max_tasks_per_scan = 10000  # Max tasks to enqueue per scan run
